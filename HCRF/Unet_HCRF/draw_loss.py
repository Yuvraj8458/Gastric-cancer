from model import*
from data import*
import os
import matplotlib.pyplot as plt
import math
import time
save_fig_path='E:\GasHisSDB\\loss&acc.png'
def training_vis(save_fig_path):
    loss = [0.5679481625556946, 0.5380799225966135, 0.5058611444632213, 0.48722575743993124, 0.46352460046609245, 0.44388269901275634, 0.43666206995646156, 0.4199470772345861, 0.40403988301753996, 0.3836087362964948, 0.363562783797582, 0.3487682159493367, 0.32840045015017194, 0.31636481751998263, 0.3042524871726831, 0.2913182608783245, 0.29793358345826465, 0.26989295889933906, 0.2582221797481179, 0.24593608836332956]
    print("loss:",loss)
    acc = [0.6156634201606115, 0.6333901839454968, 0.817853294412295, 0.8449812239408493, 0.844757384856542, 0.8466419406731923, 0.8439628853400548, 0.8438210036357244, 0.8453734834988912, 0.8463908553123474, 0.8507508552074432, 0.8509613911310832, 0.8613830184936524, 0.8635236589113872, 0.8726183712482453, 0.8773029524087906, 0.8667852771282196, 0.888672304948171, 0.8964740937948227, 0.9035592561960221]
    print("accuracy:",acc)
    val_loss = [0.5740350649754207, 0.537583548327287, 0.5161854789654414, 0.5089789163072904, 0.4885055465002855, 0.4664752702911695, 0.450641518731912, 0.4755681157608827, 0.438188905864954, 0.4000717228899399, 0.3775961586336295, 0.35898265093564985, 0.3600549180308978, 0.353113622913758, 0.35985715679824354, 0.3642916040122509, 0.3733372346063455, 0.35135550123949844, 0.34474252295990787, 0.3736404976993799]
    print("validation_loss:",val_loss)
    val_acc = [0.6109917424122493, 0.6847323445479075, 0.8296416813135147, 0.8322713991006215, 0.8328006927172343, 0.8295536148548126, 0.8323815071582794, 0.8320051834980646, 0.8314942921201388, 0.8350471826394399, 0.8428582859039306, 0.8506248585383097, 0.8495007199048996, 0.85829025944074, 0.8563365876674652, 0.8602695918083191, 0.8570747069517771, 0.8656353455781937, 0.8622481973965963, 0.8639514605204265]
    print("validation_accuracy:",val_acc)
    fig = plt.figure(figsize=(10,4))
    ax1 = fig.add_subplot(121)
    ax1.plot(loss,label =  "training_loss")
    ax1.plot(val_loss,label = "validation_loss")
    ax1.set_title("training model loss")
    ax1.set_ylabel("loss")
    ax1.set_xlabel("epoch")
    plt.legend(["training","validation"], loc="upper right")

    ax2 = fig.add_subplot(122)
    ax2.plot(acc,label =  "training_accuracy")
    ax2.plot(val_acc,label = "validation_accuracy")
    ax2.set_title("training model accuracy")
    ax2.set_ylabel("accuracy")
    ax2.set_xlabel("epoch")
    plt.legend(["training","validation"], loc="upper right")


    plt.savefig(save_fig_path)
training_vis(save_fig_path)